\clearpage 

# Tables and Figures

\clearpage 

## Figure 1 {#figure-methods -}

**Schematic illustrating the computational problem, generated data, and scoring function**. Panel (**a**) provides a schematic description of the L1000 DUO detection mode and the associated deconvolution problem to be addressed by the contestants. Panel (**b**) shows the data generated for the contest comprising 6 different sets of perturbational experiments with 3 plates of compound (CP) and shRNA treatments (KD) each. Each plate was detected using DUO (2 genes per analyte) and UNI (one gene per analyte) with UNI serving as the ground truth. Contestants were given two plates of data for training their models offline; a second set of two plates was used during the contest for testing and to populate the live leaderboard; and the third set of two was used as holdout to determine the final contestant placements. Panel (**c**) illustrates the accuracy component of the scoring function that was used to evaluate the solutions submitted by the competitors. A solution's overall accuracy score was the product of the genewise Spearman rank correlations with ground truth (DECONV data) and the AUC of extreme modulations (DE data).

\begin{figure}[htbp!]
\centering
\includegraphics[width = \textwidth]{img/schematic-methods.png}
\end{figure}

\clearpage 

## Figure 2 {#figure-tsne -}

**Clustering of solutions.** Plot of two-dimensional t-SNE projection with all the samples generated by UNI ground truth (GT) and by applying a deconvolution algorithm to DUO data. t-SNE was run once on all deconvolution data (DECONV) and once on all differential-expression (DE) data that include the 2 plates of holdout data, one each containing compound and shRNA treatments. The resulting projections were colored and subset to generate the following panels: **a**, DECONV data colored by perturbagen type; **b**, DECONV data colored by algorithm type; **c**, DE data colored by algorithm type; and **d**, DECONV data colored by algorithm type and stratified by each implementation. 

\begin{figure}[htbp!]
\centering
\includegraphics[width = \textwidth]{img/deconv-1.png}
\end{figure}  

\clearpage 

## Figure 3 {#figure-corr -}

**Correlation between ground-truth and deconvolution samples.** **a, b** show the empirical distributions of the median correlation between the ground-truth and the deconvolution data for the holdout plates. The median correlation was computed across all the submissions, including the benchmark. **a** shows the distributions for the samples of shRNA and compound treatments. **b** shows the distributions for the subset of genes in low and high bead proportion. **c, d** show the gene-wise mean and confidence intervals (95%) for the correlation coefficient for each of the top-nine performing solutions and the benchmark (BM). **c** shows the gene-wise mean correlation by implementation for the full sample. **d** shows the gene-wise mean correlation by implementation stratified by perturbagen type and bead proportion. 


<!-- 
**Correlation between ground-truth and deconvolution samples.** This figure shows the cumulative distribution of the genewise Spearman correlation coefficients between the ground-truth (UNI) and the deconvolution data (DUO) achieved by the winning random-forest method against the k-means benchmark (dpeak*) for the subset of genes in low bead proportion (**a**) and in high bead proportion (**b**) for the shRNA and compound perturbagen types. It also shows the mean (across genes) correlation and 95% CI for the top-nine performing solutions and the benchmark for the compound data of genes in low bead proportion (**c**) and those in high bead proportions (**d**), as well as the shRNA data of genes in low bead proportion (**e**) and those in high bead proportion (**f**).  Asterisks indicate statistical significance at \*\*\* 0.001, \*\* 0.05, and \* 0.1 level of a Wilcoxon-rank-sum test of location difference between the competitor's distribution and the corresponding distribution of the benchmark.
 -->


\begin{figure}[htbp!]
\centering
\includegraphics[width = \textwidth]{img/correlation-1.png}
\end{figure}

\clearpage 

## Figure 4  {#figure-auc -}

**Detection of extreme modulations and targeted knockdown genes.** This figure shows the AUC for the predicted differential expressions (DE data) obtained by the top-nine performing methods and the k-means benchmark (dpeak) and the corresponding ground-truth extreme modulations (as detected in the UNI data) both for the shRNA and compound samples (**a**). It also shows the computed recall and precision of the top-nine methods and the benchmark for the detection of the targeted knockdown genes for a subset of shRNA experiments (**b**).

<!-- ![](outcomes/detection.png) results/figs/auc-1.png-->
\begin{figure}[htbp!]
\centering
\includegraphics[width = \textwidth]{img/auc-1.png}
\end{figure}

\clearpage 

## Figure 5  {#figure-inter -}

**Variation across replicates for the top-four performing methods and the (dpeak) benchmark.** This figure shows the mean coefficient of variation for each compound perturbagen in our sample. The mean coefficient of variation is computed as the average of the ratio between the interquartile-range and the median of the deconvoluted values across 10 replicates. The perturbagens on the x-axis are ordered by increasing mean coefficient of variation of the benchmark and split into separate panels by quantiles to make differences more visible.

<!-- ![](outcomes/coef-variation.png) -->
\begin{figure}[htbp!]
\centering
\includegraphics[width = \textwidth]{img/replicability-1.png}
\end{figure}

\clearpage

## Figure 6 {#figure-ensembles -}

**Performance of ensembles.**  This figure shows the performance in the (**a**) correlation metric and (**b**) AUC metric of the ensemble based on the median prediction of all possible combinations of a given size of the top 9 algorithms plus the benchmark. The median performance of the ensemble tends to increase with its size. However, the maximum performance in both metrics tends to plateau (or even decrease) after the ensemble reaches a size equal to 3.

\begin{figure}[htbp!]
\centering
\includegraphics[width = \textwidth]{img/ensemble_final-1.png}
\end{figure}
